<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>MiniChat</title>
    <link
      rel='stylesheet'
      href='https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css'
      integrity='sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2'
      crossorigin='anonymous'
    />
  </head>
  <body class='container'>
    <h1 class='mt-5'>Minichat</h1>
    <hr />

    <form id='myForm'>
      <div class='row'>
        <div class='col-8'>
          <input
            type='text'
            id='txtMessage'
            placeholder='Message'
            class='form-control'
          />
        </div>
        <div class='col-4'>
          <button type='submit' class='btn btn-primary'>Send</button>
        </div>
      </div>
    </form>

    <div class='row'>
      <div class='col'>
        <ul id='myMessages' class='mt-2'></ul>
      </div>
    </div>

    <script
      src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.3/socket.io.js'
      integrity='sha512-Jr0UIR/Q8MUX+93zjDOhuDUKLqJZObtwpkLJQcR9qMaLgL0thet39IORuavUaZFkZ8a4ktrUsKPM9mf5LWMduA=='
      crossorigin='anonymous'
    ></script>

    <script>
      // Conexion a socket
      const socket = io('https://react-socket-server-demo.herokuapp.com/');

      // Referencias a los elementos del dom
      const myForm = document.querySelector('#myForm');
      const myMessages = document.querySelector('#myMessages');
      const txtMessage = document.querySelector('#txtMessage');

      myForm.addEventListener('submit', (e) => {
        e.preventDefault();

        const newMessage = txtMessage.value;
        // console.log(newMessage)
        socket.emit('message-to-server', { text: newMessage });
      });

      socket.on('message-from-server', (data) => {
        //   console.log(data);
        myMessages.innerHTML += `<li>${data.text}</li>`;
      });

      //   socket.on('mensaje-bienvenida', (data) => {
      //     console.log(data);
      //   });

      setTimeout(() => {
        // emitir un evento
        // socket.emit('mensaje-cliente', { msg: 'Cliente', nombre: 'Juan' });
      }, 2000);
    </script>
  </body>
</html>
